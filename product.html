<!DOCTYPE html>
<html lang="ua">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Сторінка товару</title>
    <link rel="stylesheet" href="./css/product.css" />
    <link rel="stylesheet" href="./css/global.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="bg-top"></div>
    <header class="container-s justify_between">
      <a href="/">
        <img
          src="./assets/images/logo.svg"
          alt="logo"
          width="200"
          height="30"
        />
      </a>
      <nav class="h_nav align_center">
        <a href="/">Головна</a>
        <div class="h_select">
          <div class="align_center" onclick="showCatalog(1)">
            <span>Штори</span>
            <img
              src="./assets/images/header/arrow.svg"
              alt="arrow"
              height="12"
              width="6"
              id="arrow_s1"
              class="arrow_ss"
            />
          </div>
          <div id="catalog_s1" class="burger_th"></div>
        </div>
        <div class="h_select">
          <div class="align_center" onclick="showCatalog(2)">
            <span>Тюль</span>
            <img
              src="./assets/images/header/arrow.svg"
              alt="arrow"
              height="12"
              width="6"
              id="arrow_s2"
              class="arrow_ss"
            />
          </div>
          <div id="catalog_s2" class="burger_th"></div>
        </div>
        <div class="h_select">
          <div class="align_center" onclick="showCatalog(3)">
            <span>Тасьма</span>
            <img
              src="./assets/images/header/arrow.svg"
              alt="arrow"
              height="12"
              width="6"
              id="arrow_s3"
              class="arrow_ss"
            />
          </div>
          <div id="catalog_s3" class="burger_th"></div>
        </div>
        <a href="/catalog">Інше</a>
        <a href="/cart" style="display: flex; position: relative" id="cart-btn">
          <img
            src="./assets/images/header/cart.svg"
            alt="cart"
            height="21"
            width="24"
          />
        </a>
      </nav>
      <div class="h_burger">
        <img
          src="./assets/images/header/burger.svg"
          alt="burger"
          width="26"
          height="17"
          onclick="showBurger()"
        />
        <div class="mob_burg">
          <img
            src="./assets/images/home/close.svg"
            alt="close"
            width="21"
            height="21"
            onclick="closeBurger()"
          />
          <div>
            <a href="/" style="margin-bottom: 10px">Головна</a>
            <div class="hm_nav">
              <div class="align_center" onclick="showMobCatalog(1)">
                <div class="title-hm">
                  <span>Штори</span>
                  <img
                    src="./assets/images/header/arrow.svg"
                    alt="arrow"
                    height="12"
                    width="6"
                    id="arrow_s1"
                    class="arrow_ss"
                  />
                </div>
              </div>
              <div id="catalog_sm1"></div>
            </div>
            <div class="hm_nav">
              <div class="align_center" onclick="showMobCatalog(2)">
                <div class="title-hm">
                  <span>Тюль</span>
                  <img
                    src="./assets/images/header/arrow.svg"
                    alt="arrow"
                    height="12"
                    width="6"
                    id="arrow_s1"
                    class="arrow_ss"
                  />
                </div>
              </div>
              <div id="catalog_sm2"></div>
            </div>
            <div class="hm_nav">
              <div class="align_center" onclick="showMobCatalog(3)">
                <div class="title-hm">
                  <span>Тасьма</span>
                  <img
                    src="./assets/images/header/arrow.svg"
                    alt="arrow"
                    height="12"
                    width="6"
                    id="arrow_s1"
                    class="arrow_ss"
                  />
                </div>
              </div>
              <div id="catalog_sm3"></div>
            </div>
            <a href="/catalog">Інше</a>
          </div>
        </div>
      </div>
    </header>
    <div id="cart_modal">
      <div class="cart_block">
        <img
          src="./assets/images/home/close.svg"
          alt="close"
          width="21"
          height="21"
          onclick="closeModal()"
        />
        <div>
          <h2>Додано в кошик</h2>
          <img src="" alt="c1" width="398" height="194" id="modal-img" />
          <div class="cart_info" id="modal-title">
            <span>Тканина для штор:</span>
          </div>
          <div class="cart_info" id="modal-color"><span>Колір:</span></div>
          <div class="cart_info-m">
            <div>
              <input
                type="text"
                class="input-ds"
                value="1"
                id="modal-inp"
                disabled
              />
              <div>пог.м</div>
            </div>
            <div id="modal-price">00.00 грн</div>
          </div>
        </div>
        <button class="button-bg" onclick="goCart()">До кошика</button>
      </div>
    </div>
    <main>
      <div class="pages container-s">
        <a href="/catalog">Каталог</a>
        <img
          src="./assets/images/header/arrow.svg"
          alt="arrow"
          width="12"
          height="12"
        />
      </div>
      <div class="container-s product">
        <div class="product-top">
          <div class="product-tl">
            <img id="image" src="" alt="image-main" />
            <div>
              <img id="image_s1" src="" alt="image-sec1" />
              <img id="image_s2" src="" alt="image-sec2" />
              <img id="image_s3" src="" alt="image-sec3" />
            </div>
            <div>
              Зверніть увагу! Колірна гамма виробу залежить від налаштувань
              вашого монітора і може відрізнятися від реального.
            </div>
          </div>
          <div class="product-tr">
            <h1 id="title">...</h1>
            <p id="price">1550.00 грн / пог.м</p>
            <div>
              <input type="text" value="1" class="input-ds" id="value-inp" />
              <span>пог.м</span>
            </div>
            <div>
              <div>Кольор:</div>
              <div id="colors"></div>
            </div>
            <button class="button-bg" onclick="showModal()">
              Додати в кошик
            </button>
          </div>
        </div>
        <div class="product-bot">
          <div class="product-bf" id="first">
            <h2 onclick="showInfo('first')">Характеристики</h2>
            <div>
              <div class="table-block">
                <div>Склад</div>
                <div id="composition">-</div>
              </div>
              <div class="table-block">
                <div>Малюнок</div>
                <div id="figure">-</div>
              </div>
              <div class="table-block">
                <div>Виробник</div>
                <div id="manufacturer">-</div>
              </div>
              <div class="table-block">
                <div>Щільність тканини</div>
                <div id="density">-</div>
              </div>
              <div class="table-block">
                <div>Захист від сонця</div>
                <div id="protection">-</div>
              </div>
              <div class="table-block">
                <div>Догляд</div>
                <div id="care">-</div>
              </div>
            </div>
          </div>
          <div class="product-bs" id="second">
            <h2 onclick="showInfo('second')">Інформація про замовлення</h2>
            <div>
              Після замовлення з вами зв'яжуться працівники магазину, щоб
              уточнити деталі, такі як час виготовлення, вибір кріплення та
              тасьми. Ви можете переглянути їх тут.
            </div>
          </div>
          <div class="product-bl" id="last">
            <h2 onclick="showInfo('last')">Доставка і оплата</h2>
            <div>
              <div>
                <h3>Спосіб отримання товару:</h3>
                <div>
                  Самовівіз — із магазин у м. Полтава, там ви можете особисто
                  забрати готовий товар.
                </div>
              </div>
              <div>
                <h3>Способи оплати товару:</h3>
                <ul>
                  <li>
                    100% передплата — оплата за перерахування на рахунок ФОП*.
                  </li>
                  <li>
                    50% / 30% передплата — оплата половини вартості за
                    перерахуванням на рахунок ФОП*.
                  </li>
                </ul>
              </div>
              <div>
                Установа банку - ПриватБанк<br />
                МФО банку - ********<br />
                Отримувач платежу - ФОП ****** ****** ********<br />
                IBAN - UA ***********************<br />
                Валюта рахунку - UAH<br />
                РНОКПП отримувача - ********<br />
                Призначення платежу - ЗА ТОВАР
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <a href="/#contact" class="req-br" style="z-index: 5">
      <img src="./assets/images/req.svg" alt="req-br" width="13" height="24" />
    </a>
    <footer>Copyright © 2024 “Галерея штор”. Усі права захищені.</footer>

    <script src="./js/cart.js"></script>

    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const id = urlParams.get("id");

      fetch(`./server/product/get_product.php?id=${id}`, {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((response) => response.json())
        .then((res) => {
          let pages = document.getElementsByClassName("pages")[0];

          let page1 = document.createElement("a");
          page1.href = "/catalog";
          page1.textContent = res.rows_i.catalog_name;
          pages.appendChild(page1);

          let img1 = document.createElement("img");
          img1.src = "./assets/images/header/arrow.svg";
          img1.alt = "arrow";
          img1.width = 12;
          img1.height = 12;
          pages.appendChild(img1);

          let page2 = document.createElement("a");
          page2.href = `/subcatalog?id=${res.rows_i.sc_id}`;
          page2.textContent = res.rows_i.subcatalog_name;
          pages.appendChild(page2);

          let img2 = document.createElement("img");
          img2.src = "./assets/images/header/arrow.svg";
          img2.alt = "arrow";
          img2.width = 12;
          img2.height = 12;
          pages.appendChild(img2);

          let page3 = document.createElement("div");
          page3.textContent = res.rows.name;
          page3.style.color = "#212121";
          pages.appendChild(page3);

          let colors = document.getElementById("colors");
          res.rows.colors.split("/").forEach((element, i) => {
            let block = document.createElement("div");
            block.onclick = function (event) {
              document
                .getElementsByClassName("selected")[0]
                .classList.remove("selected");
              event.currentTarget.classList.add("selected");
            };
            if (i === 0) block.classList.add("selected");
            let svg = document.createElement("img");
            svg.src = `./assets/images/colors/${element}`;
            svg.alt = element.split(".")[0];
            svg.width = 32;
            svg.height = 32;
            block.appendChild(svg);
            colors.appendChild(block);
          });

          document.getElementById("title").textContent = res.rows.name;

          let imgM1 = document.getElementById("image");
          imgM1.src = `./assets/images/products/${res.rows.image}`;
          imgM1.alt = res.rows.image.split(".")[0];
          let imgM11 = document.getElementById("image_s1");
          imgM11.src = `./assets/images/products/${res.rows.image_s1}`;
          imgM11.alt = res.rows.image_s1.split(".")[0];
          let imgM12 = document.getElementById("image_s2");
          imgM12.src = `./assets/images/products/${res.rows.image_s2}`;
          imgM12.alt = res.rows.image_s2.split(".")[0];
          let imgM13 = document.getElementById("image_s3");
          imgM12.src = `./assets/images/products/${res.rows.image_s3}`;
          imgM12.alt = res.rows.image_s3.split(".")[0];

          document.getElementById(
            "price"
          ).textContent = `${res.rows.price} грн / пог.м`;

          document.getElementById("composition").textContent =
            res.rows.composition;
          document.getElementById("figure").textContent = res.rows.figure;
          document.getElementById("manufacturer").textContent =
            res.rows.manufacturer;
          document.getElementById("density").textContent = res.rows.density;
          document.getElementById("protection").textContent =
            res.rows.protection;
          document.getElementById("care").textContent = res.rows.care;
        })
        .catch((error) => console.error("Помилка загрузки продукта:", error));
    </script>

    <script>
      function goCart() {
        window.location.href = "/cart";
      }

      function addCart() {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get("id");

        updateCartData({
          id: id,
          name: document.getElementById("title").textContent,
          image: document.getElementById("image").src.split("/").pop(),
          color: document.getElementsByClassName("selected")[0].children[0].alt,
          price: (
            parseFloat(document.getElementById("price").textContent) *
            document.getElementById("value-inp").value
          ).toFixed(2),
          value: document.getElementById("value-inp").value,
        });

        closeModal();
      }

      function showInfo(id) {
        let info = document.getElementById(id);

        if (info.classList.contains("active")) info.classList.remove("active");
        else info.classList.add("active");
      }

      function eventCloseCare(e) {
        if (!e.target.closest(".cart_block")) closeModal();
      }
      function closeModal() {
        document.getElementById("cart_modal").classList.remove("active");
        allScroll();

        document.removeEventListener("click", eventCloseCare);
      }

      function showModal() {
        let modalTitle = document.getElementById("modal-title");
        if (modalTitle.childNodes.length > 2) {
          modalTitle.removeChild(modalTitle.lastChild);
        }
        let modalColor = document.getElementById("modal-color");
        if (modalColor.childNodes.length > 1) {
          modalColor.removeChild(modalColor.lastChild);
        }

        document.getElementById(
          "modal-img"
        ).src = `./assets/images/products/${document
          .getElementById("image")
          .src.split("/")
          .pop()}`;
        const title = document.createTextNode(
          ` ${document.getElementById("title").textContent}`
        );
        modalTitle.appendChild(title);
        const color = document.createTextNode(
          ` ${document.getElementsByClassName("selected")[0].children[0].alt}`
        );
        modalColor.appendChild(color);
        document.getElementById("modal-inp").value =
          document.getElementById("value-inp").value;
        document.getElementById("modal-price").textContent = `${(
          parseFloat(document.getElementById("price").textContent) *
          parseInt(document.getElementById("value-inp").value)
        ).toFixed(2)} грн`;

        addCart();
        document.getElementById("cart_modal").classList.add("active");
        disScroll();

        setTimeout(() => {
          document.addEventListener("click", eventCloseCare);
        }, 500);
      }
    </script>

    <script src="./js/header.js"></script>
    <script src="./js/global.js"></script>
  </body>
</html>

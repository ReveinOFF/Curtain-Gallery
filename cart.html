<!DOCTYPE html>
<html lang="ua">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Кошик</title>
    <link rel="stylesheet" href="./css/cart.css" />
    <link rel="stylesheet" href="./css/global.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="bg-top"></div>
    <header class="container-s justify_between">
      <a href="/">
        <img
          src="./assets/images/logo.svg"
          alt="logo"
          width="200"
          height="30"
        />
      </a>
      <nav class="h_nav align_center">
        <a href="/">Головна</a>
        <div class="h_select">
          <div class="align_center" onclick="showCatalog(1)">
            <span>Штори</span>
            <img
              src="./assets/images/header/arrow.svg"
              alt="arrow"
              height="12"
              width="6"
              id="arrow_s1"
              class="arrow_ss"
            />
          </div>
          <div id="catalog_s1" class="burger_th"></div>
        </div>
        <div class="h_select">
          <div class="align_center" onclick="showCatalog(2)">
            <span>Тюль</span>
            <img
              src="./assets/images/header/arrow.svg"
              alt="arrow"
              height="12"
              width="6"
              id="arrow_s2"
              class="arrow_ss"
            />
          </div>
          <div id="catalog_s2" class="burger_th"></div>
        </div>
        <div class="h_select">
          <div class="align_center" onclick="showCatalog(3)">
            <span>Тасьма</span>
            <img
              src="./assets/images/header/arrow.svg"
              alt="arrow"
              height="12"
              width="6"
              id="arrow_s3"
              class="arrow_ss"
            />
          </div>
          <div id="catalog_s3" class="burger_th"></div>
        </div>
        <a href="/catalog">Інше</a>
        <a href="/cart" style="display: flex; position: relative" id="cart-btn">
          <img
            src="./assets/images/header/cart.svg"
            alt="cart"
            height="21"
            width="24"
          />
        </a>
      </nav>
      <div class="h_burger">
        <img
          src="./assets/images/header/burger.svg"
          alt="burger"
          width="26"
          height="17"
          onclick="showBurger()"
        />
        <div class="mob_burg">
          <img
            src="./assets/images/home/close.svg"
            alt="close"
            width="21"
            height="21"
            onclick="closeBurger()"
          />
          <div>
            <a href="/" style="margin-bottom: 10px">Головна</a>
            <div class="hm_nav">
              <div class="align_center" onclick="showMobCatalog(1)">
                <div class="title-hm">
                  <span>Штори</span>
                  <img
                    src="./assets/images/header/arrow.svg"
                    alt="arrow"
                    height="12"
                    width="6"
                    id="arrow_s1"
                    class="arrow_ss"
                  />
                </div>
              </div>
              <div id="catalog_sm1"></div>
            </div>
            <div class="hm_nav">
              <div class="align_center" onclick="showMobCatalog(2)">
                <div class="title-hm">
                  <span>Тюль</span>
                  <img
                    src="./assets/images/header/arrow.svg"
                    alt="arrow"
                    height="12"
                    width="6"
                    id="arrow_s1"
                    class="arrow_ss"
                  />
                </div>
              </div>
              <div id="catalog_sm2"></div>
            </div>
            <div class="hm_nav">
              <div class="align_center" onclick="showMobCatalog(3)">
                <div class="title-hm">
                  <span>Тасьма</span>
                  <img
                    src="./assets/images/header/arrow.svg"
                    alt="arrow"
                    height="12"
                    width="6"
                    id="arrow_s1"
                    class="arrow_ss"
                  />
                </div>
              </div>
              <div id="catalog_sm3"></div>
            </div>
            <a href="/catalog">Інше</a>
          </div>
        </div>
      </div>
    </header>
    <main>
      <div class="pages container-s">
        <div>Кошик</div>
        <img
          src="./assets/images/header/arrow.svg"
          alt="arrow"
          width="12"
          height="12"
        />
      </div>
      <div class="cart container-s">
        <h1>Ваш кошик</h1>
        <div class="cart_block">
          <div class="cart-ti">
            <div>Товар</div>
            <div>Кількість</div>
            <div>Ціна</div>
          </div>
          <div class="cart-bp" id="cart_block"></div>
        </div>
        <div class="cart-sum">
          <div>
            <div>Вього:</div>
            <div id="totalPrice">00.00 грн</div>
          </div>
          <button class="button-bg" onclick="goOrder()">До сплати</button>
        </div>
      </div>
    </main>
    <a href="/#contact" class="req-br" style="z-index: 5">
      <img src="./assets/images/req.svg" alt="req-br" width="13" height="24" />
    </a>
    <footer>Copyright © 2024 “Галерея штор”. Усі права захищені.</footer>

    <script src="./js/cart.js"></script>

    <script>
      function goOrder() {
        window.location.href = "/order";
      }

      function priceTotal(data) {
        const totalPrice = data
          .reduce((sum, item) => sum + parseFloat(item.price), 0)
          .toFixed(2);
        document.getElementById("totalPrice").textContent = `${totalPrice} грн`;
      }

      let data = getCartData();

      let cart_block = document.getElementById("cart_block");
      data.forEach((element) => {
        let cart_item = document.createElement("div");
        cart_item.className = "cart-prod";
        cart_item.id = element.id;

        let div1 = document.createElement("div");
        let img = document.createElement("img");
        img.src = `./assets/images/products/${element.image}`;
        img.alt = element.image.split(".")[0];
        div1.appendChild(img);
        let div11 = document.createElement("div");
        div11.className = "cart-prod-inf";
        let div111 = document.createElement("div");
        let span111 = document.createElement("span");
        span111.textContent = "Тканина для штор:";
        let text111 = document.createTextNode(` ${element.name}`);
        div111.appendChild(span111);
        div111.appendChild(text111);
        div11.appendChild(div111);
        let div112 = document.createElement("div");
        let span112 = document.createElement("span");
        span112.textContent = "Колір:";
        let text112 = document.createTextNode(` ${element.color}`);
        div112.appendChild(span112);
        div112.appendChild(text112);
        div11.appendChild(div112);
        div1.appendChild(div11);
        cart_item.appendChild(div1);

        let div2 = document.createElement("div");
        div2.className = "cart-prod-num";
        let input = document.createElement("input");
        input.type = "text";
        input.className = "input-ds";
        input.id = `input-${element.id}`;
        input.value = data.find((item) => item.id === element.id).value;
        input.oninput = function (event) {
          setTimeout(() => {
            const existingData = getCartData();
            const updatedData = existingData.map((item) => {
              if (item.id == event.target.id.split("-")[1]) {
                return {
                  ...item,
                  value: event.target.value,
                  price: element.mainprice * event.target.value,
                };
              }
              return item;
            });
            localStorage.setItem("cart", JSON.stringify(updatedData));
            data = getCartData();
            priceTotal(data);
            let pb = document.getElementById(element.id);
            let price = data
              .find((item) => item.id == element.id)
              .price.toFixed(2);
            pb.children[2].textContent = `${price} грн`;
          }, 1000);
        };
        div2.appendChild(input);
        let span = document.createElement("span");
        span.textContent = "пог.м";
        div2.appendChild(span);
        cart_item.appendChild(div2);

        let div3 = document.createElement("div");
        div3.textContent = `${element.price.toFixed(2)} грн`;
        div3.className = "cart-prod-price";
        cart_item.appendChild(div3);

        let close = document.createElement("img");
        close.src = "./assets/images/home/close.svg";
        close.alt = "remove";
        close.width = 21;
        close.height = 21;
        close.onclick = function () {
          removeCartItem(element.id);
          let remove = document.getElementById(element.id);
          document.getElementById("cart_block").removeChild(remove);
          data = getCartData();
          priceTotal(data);
        };
        cart_item.appendChild(close);

        cart_block.appendChild(cart_item);

        priceTotal(data);
      });
    </script>

    <script src="./js/header.js"></script>
    <script src="./js/global.js"></script>
  </body>
</html>
